<!DOCTYPE html>
<html>
<head>
  <title>Checkout</title>
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</head>
<body>
  <script>
    var options = {
      "key": "<%= key_id %>",
      "amount": "<%= amountINR * 100 %>",
      "currency": "INR",
      "name": "Donation Payment",
      "description": "Donation for Kankpul Utsav",
      "order_id": "<%= order_id %>",
      "handler": function(response) {
        var form = document.createElement('form');
        form.method = 'POST';
        form.action = '/payment-success';

        var fields = {
          razorpay_payment_id: response.razorpay_payment_id,
          razorpay_order_id: response.razorpay_order_id,
          razorpay_signature: response.razorpay_signature,
          fullName: "<%= fullName %>",
          address: "<%= address %>",
          mobile: "<%= mobile %>",
          email: "<%= email %>",
          amountINR: "<%= amountINR %>",
          comment: "<%= comment %>"
        };

        for (var key in fields) {
          var hiddenField = document.createElement('input');
          hiddenField.type = 'hidden';
          hiddenField.name = key;
          hiddenField.value = fields[key];
          form.appendChild(hiddenField);
        }

        document.body.appendChild(form);
        form.submit();
      },
      "prefill": {
        "name": "<%= fullName %>",
        "email": "<%= email %>",
        "contact": "<%= mobile %>"
      },
      "theme": {
        "color": "#3399cc"
      }
    };
    var rzp1 = new Razorpay(options);
    rzp1.open();
  </script>
</body>
</html>
